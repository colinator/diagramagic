<diag:diagram xmlns="http://www.w3.org/2000/svg"
              xmlns:diag="https://diagramagic.ai/ns"
              diag:padding="20">
  <style>
    .entry { fill:#f9f6e7; stroke:#555; stroke-width:1.2; rx:16; }
    .a { fill:#e9f0ff; stroke:#5b6ac9; stroke-width:1; rx:10; }
    .b { fill:#eef8ec; stroke:#4d9c5c; stroke-width:1; rx:10; }
    .t { font-size:13px; }
  </style>

  <diag:graph layout="layered" routing="curved" quality="high" direction="TB" node-gap="34" rank-gap="56">
    <diag:node id="start" width="120" padding="10" background-class="entry"><text class="t">start</text></diag:node>

    <diag:node id="a0" width="86" padding="10" background-class="a"><text class="t">a0</text></diag:node>
    <diag:node id="a1" width="86" padding="10" background-class="a"><text class="t">a1</text></diag:node>
    <diag:node id="a2" width="86" padding="10" background-class="a"><text class="t">a2</text></diag:node>
    <diag:node id="a3" width="86" padding="10" background-class="a"><text class="t">a3</text></diag:node>

    <diag:node id="b0" width="86" padding="10" background-class="b"><text class="t">b0</text></diag:node>
    <diag:node id="b1" width="86" padding="10" background-class="b"><text class="t">b1</text></diag:node>
    <diag:node id="b2" width="86" padding="10" background-class="b"><text class="t">b2</text></diag:node>
    <diag:node id="b3" width="86" padding="10" background-class="b"><text class="t">b3</text></diag:node>

    <diag:node id="end" width="110" padding="10" background-class="entry"><text class="t">end</text></diag:node>

    <diag:edge from="start" to="a0"/>
    <diag:edge from="start" to="b0"/>

    <diag:edge from="a0" to="a1"/>
    <diag:edge from="a1" to="a2"/>
    <diag:edge from="a2" to="a3"/>
    <diag:edge from="a3" to="end"/>

    <diag:edge from="b0" to="b1"/>
    <diag:edge from="b1" to="b2"/>
    <diag:edge from="b2" to="b3"/>
    <diag:edge from="b3" to="end"/>

    <diag:edge from="a1" to="b3" stroke-dasharray="4 2"/>
    <diag:edge from="b1" to="a3" stroke-dasharray="4 2"/>

    <diag:edge from="a3" to="a0" stroke="#777"/>
    <diag:edge from="b3" to="b1" stroke="#777"/>
  </diag:graph>
</diag:diagram>
